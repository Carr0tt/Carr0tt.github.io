<!DOCTYPE html>
<html>

<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.3/dist/aframe-extras.min.js"></script>
</head>

<body>
    <a-scene>
        <a-assets>
            <img id="marker"
                src="https://raw.githubusercontent.com/jeromeetienne/AR.js/master/three.js/examples/marker-training/examples/generator.html" />
        </a-assets>

        <a-camera gps-camera rotation-reader>
            <a-entity id="marker" geometry="primitive: plane; width: 1; height: 1" material="src: #marker"
                position="0 0 -5"></a-entity>
        </a-camera>

        <a-entity ar-marker></a-entity>

        <a-entity environment></a-entity>
    </a-scene>

    <script>
        AFRAME.registerComponent('ar-marker', {
            init: function () {
                var marker = document.querySelector('#marker');
                var camera = document.querySelector('[gps-camera]');
                var rotationReader = document.querySelector('[rotation-reader]');

                // 固定 AR 物体
                marker.setAttribute('gps-entity-place', {
                    latitude: camera.getAttribute('gps-camera').latitude,
                    longitude: camera.getAttribute('gps-camera').longitude
                });

                //绑定 AR 物体到相机前方一定距离的位置
                rotationReader.addEventListener('rotationChanged', function () {
                    var position = new THREE.Vector3(0, 0, -5);
                    position.applyQuaternion(camera.object3D.getWorldQuaternion());
                    position.add(camera.object3D.position);
                    marker.setAttribute('position', position);
                });
            }
        });
    </script>
</body>

</html>